<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Unity WebGL Player | Monopoly</title>
</head>
<body style="text-align: center; padding: 0; border: 0; margin: 0;">
    <div id="unity-container" style="position: absolute; width: 100%; height: 100%">
        <canvas id="unity-canvas" style="width: 100%; height: 100%"></canvas>
    </div>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="Build/monopoly-hosting.loader.js"></script>
    <script>
        // Получение данных из Telegram
        const tg = window.Telegram.WebApp;
        tg.expand();

        const initDataUnsafe = tg.initDataUnsafe;
        const user = initDataUnsafe.user;
        const userId = user ? user.id : null;

        // Передача user_id в Unity
        createUnityInstance(document.querySelector("#unity-canvas"), {
            dataUrl: "Build/monopoly-hosting.data.unityweb",
            frameworkUrl: "Build/monopoly-hosting.framework.js.unityweb",
            codeUrl: "Build/monopoly-hosting.wasm.unityweb",
            streamingAssetsUrl: "StreamingAssets",
            companyName: "DefaultCompany",
            productName: "monopoly",
            productVersion: "0.1",
        }).then((unityInstance) => {
            globalUnityInstance = unityInstance;
        
            unityInstance.SendMessage('StartupManager', 'OnReceiveUserId', '111');

            if (userId) {
                unityInstance.SendMessage('GameWindow', 'OnReceiveUserId', userId);
            }
            else{
                unityInstance.SendMessage('GameWindow', 'OnReceiveUserId', -1);
            }
        }).catch((message) => {
            console.error(message);
        });
    </script>
</body>
</html>